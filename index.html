
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConKeep - 옥수수 테마 기프티콘 관리</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#f59e0b">
    <script src="https://unpkg.com/@zxing/library@latest/umd/index.min.js"></script>
</head>
<body>
    <!-- 로딩 화면 -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="corn-loader">🌽</div>
            <h2>ConKeep</h2>
            <p>기프티콘을 관리하는 가장 쉬운 방법</p>
        </div>
    </div>

    <!-- 메인 앱 -->
    <div id="app" class="app" style="display: none;">
        <!-- 헤더 -->
        <header class="header">
            <div class="header-content">
                <h1 class="app-title">
                    <span class="corn-icon">🌽</span>
                    ConKeep
                </h1>
                <div class="header-actions">
                    <button id="theme-toggle" class="icon-btn" title="테마 변경">
                        <span class="theme-icon">🌙</span>
                    </button>
                    <button id="settings-btn" class="icon-btn" title="설정">
                        ⚙️
                    </button>
                </div>
            </div>
        </header>

        <!-- 탭 네비게이션 -->
        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="dashboard">
                <span class="tab-icon">📊</span>
                대시보드
            </button>
            <button class="tab-btn" data-tab="add">
                <span class="tab-icon">➕</span>
                등록
            </button>
        </nav>

        <!-- 대시보드 탭 -->
        <div id="dashboard-tab" class="tab-content active">
            <!-- 통계 카드 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">📋</div>
                    <div class="stat-info">
                        <div class="stat-number" id="total-count">0</div>
                        <div class="stat-label">전체 쿠폰</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">✨</div>
                    <div class="stat-info">
                        <div class="stat-number" id="unused-count">0</div>
                        <div class="stat-label">사용 가능</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⏰</div>
                    <div class="stat-info">
                        <div class="stat-number" id="expiring-count">0</div>
                        <div class="stat-label">만료 임박</div>
                    </div>
                </div>
            </div>

            <!-- 검색 및 필터 -->
            <div class="search-filter-section">
                <div class="search-container">
                    <input type="text" id="search-input" placeholder="브랜드 또는 상품명으로 검색..." class="search-input">
                    <button id="filter-btn" class="filter-btn">🔍</button>
                </div>
                
                <!-- 정렬 컨트롤 컨테이너 -->
                <div id="sort-container" class="sort-container"></div>
                
                <div id="filter-panel" class="filter-panel hidden">
                    <div class="filter-group">
                        <label for="brand-filter">브랜드</label>
                        <select id="brand-filter" class="filter-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="status-filter">상태</label>
                        <select id="status-filter" class="filter-select">
                            <option value="">전체</option>
                            <option value="unused">사용 가능</option>
                            <option value="used">사용 완료</option>
                            <option value="expired">만료됨</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 쿠폰 그리드 -->
            <div id="coupons-grid" class="coupons-grid">
                <!-- 빈 상태 -->
                <div id="empty-state" class="empty-state">
                    <div class="empty-icon">🌽</div>
                    <h3>아직 등록된 쿠폰이 없어요</h3>
                    <p>첫 번째 기프티콘을 등록해보세요!</p>
                    <button onclick="switchTab('add')" class="primary-btn corn-primary">쿠폰 등록하기</button>
                </div>
            </div>
        </div>

        <!-- 등록 탭 -->
        <div id="add-tab" class="tab-content">
            <div class="add-coupon-container">
                <h2>새 쿠폰 등록</h2>
                
                <!-- 카테고리 선택 컨테이너 -->
                <div id="category-container" class="category-container"></div>
                
                <!-- 파일 업로드 영역 -->
                <div id="upload-area" class="upload-area">
                    <div class="upload-icon">📷</div>
                    <p>기프티콘 이미지를 업로드하세요</p>
                    <small>클릭하거나 드래그하여 업로드</small>
                    <input type="file" id="file-input" accept="image/*" hidden>
                </div>

                <!-- 이미지 미리보기 -->
                <div id="preview-section" class="preview-section hidden">
                    <img id="preview-image" class="preview-image" alt="미리보기">
                    <div class="scan-overlay" id="scan-overlay">
                        <div class="scan-loader">
                            <div class="corn-loader">🌽</div>
                            <p>바코드를 스캔하고 있습니다...</p>
                        </div>
                    </div>
                </div>

                <!-- AI 분석 결과 -->
                <div id="ai-analysis" class="ai-analysis hidden">
                    <h3>🤖 AI 분석 완료</h3>
                    <p>이미지에서 정보를 추출했습니다. 확인해주세요!</p>
                </div>

                <!-- 쿠폰 정보 입력 폼 -->
                <div class="coupon-form">
                    <div class="form-group">
                        <label for="coupon-code">바코드 번호</label>
                        <div class="input-with-btn">
                            <input type="text" id="coupon-code" placeholder="바코드 번호" class="form-input">
                            <button type="button" id="rescan-btn" class="secondary-btn">다시 스캔</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="coupon-brand">브랜드</label>
                        <input type="text" id="coupon-brand" placeholder="브랜드명" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="coupon-name">상품명</label>
                        <input type="text" id="coupon-name" placeholder="상품명" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="coupon-amount">금액 (원)</label>
                        <input type="number" id="coupon-amount" placeholder="금액을 입력하세요" class="form-input">
                    </div>

                    <div class="form-group">
                        <label for="coupon-expiry">만료일</label>
                        <input type="date" id="coupon-expiry" class="form-input">
                    </div>

                    <div class="form-actions">
                        <button type="button" id="cancel-add" class="secondary-btn">취소</button>
                        <button type="button" id="save-coupon" class="primary-btn corn-primary">저장</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 쿠폰 상세 모달 -->
    <div id="coupon-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-coupon-title">쿠폰 상세</h2>
                <button class="close-btn" data-modal="coupon">×</button>
            </div>
            <div class="modal-body">
                <div class="coupon-detail">
                    <img id="modal-coupon-image" class="coupon-image" alt="쿠폰 이미지">
                    <div class="coupon-info">
                        <div class="info-row">
                            <span class="info-label">브랜드:</span>
                            <span id="modal-coupon-brand"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">상품명:</span>
                            <span id="modal-coupon-name"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">금액:</span>
                            <span id="modal-coupon-amount"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">만료일:</span>
                            <span id="modal-coupon-expiry"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">바코드:</span>
                            <span id="modal-coupon-code"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="toggle-used" class="primary-btn corn-primary">사용 완료</button>
                <button id="share-coupon" class="secondary-btn">공유</button>
                <button id="delete-coupon" class="danger-btn">삭제</button>
            </div>
        </div>
    </div>

    <!-- 설정 모달 -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>설정</h2>
                <button class="close-btn" data-modal="settings">×</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>AI 분석 설정</h3>
                    <div class="form-group">
                        <label for="api-key-input">OpenAI API 키</label>
                        <input type="password" id="api-key-input" placeholder="API 키를 입력하세요" class="form-input">
                        <small>AI 분석 기능을 사용하려면 OpenAI API 키가 필요합니다.</small>
                    </div>
                </div>

                <!-- 알림 설정 컨테이너 -->
                <div id="notification-settings-container" class="notification-settings-container"></div>

                <div class="settings-section">
                    <h3>데이터 관리</h3>
                    <div class="settings-buttons">
                        <button id="export-data" class="secondary-btn">데이터 내보내기</button>
                        <button id="clear-data" class="danger-btn">모든 데이터 삭제</button>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="save-api-key" class="primary-btn corn-primary">저장</button>
            </div>
        </div>
    </div>

    <!-- 토스트 컨테이너 -->
    <div id="toast-container" class="toast-container"></div>

    <!-- 공유 페이지 (숨김 상태) -->
    <div id="share-page" class="share-page hidden">
        <div class="share-content">
            <div class="share-header">
                <h1>🌽 ConKeep 공유 쿠폰</h1>
            </div>
            <div class="shared-coupon">
                <img id="share-coupon-image" class="shared-coupon-image" alt="공유된 쿠폰">
                <div class="shared-coupon-info">
                    <h2 id="share-coupon-title"></h2>
                    <div class="shared-info-row">
                        <span class="shared-label">브랜드:</span>
                        <span id="share-coupon-brand"></span>
                    </div>
                    <div class="shared-info-row">
                        <span class="shared-label">금액:</span>
                        <span id="share-coupon-amount"></span>
                    </div>
                    <div class="shared-info-row">
                        <span class="shared-label">만료일:</span>
                        <span id="share-coupon-expiry"></span>
                    </div>
                    <div class="shared-usage-control">
                        <label class="usage-toggle">
                            <input type="checkbox" id="share-usage-toggle">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">사용 완료</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 공유 모달 컨테이너 -->
    <div id="share-modal-container"></div>

    <script type="module" src="src/main-app.js"></script>
</body>
</html>
